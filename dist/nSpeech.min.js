/*!
 * nSpeech
 * nSpeech is screen reader library.
 *
 * https://github.com/nkhr7/nSpeech/
 *
 * Copyright 2017, Koichi Yoshimoto
 *
 * Version: 1.0.0
 *
 * Licensed under MIT
 *
 * Released on: 2017.09.29
 */
!function(n,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():n.nSpeech=t()}(this,function(){"use strict";var n=function(t,e){if("undefined"!=typeof SpeechSynthesisUtterance){var o=Object.create(n.prototype),r=void 0!==t?t:".speech",i=[],c=window.speechSynthesis;"object"==typeof t&&(e=r,r=".speech"),o.options={lang:"",voice:null,volume:1,rate:1,pitch:1,text:"",onend:function(){},onstart:function(){},onerror:function(){},onmark:function(){},debug:!1},o.elements={},o.utterance=new window.SpeechSynthesisUtterance;var u=function(){o.elements=a(r),f(),s(e),i.length>0&&(p(),l(),d())},a=function(n){document.querySelectorAll(n)},f=function(){i=c.getVoices()},s=function(n){"object"==typeof n&&Object.keys(n).forEach(function(t){o.options[t]=n[t]})},p=function(){var n={};if(i.length)for(var t in i){if(i[t].lang===o.options.lang)return o.options.voice=i[t],!0;!0===i[t].default&&(n=i[t])}return o.options.voice=n,!1},l=function(){for(var n=m(o.options.text),t=o.elements.length,e=0;e<t;++e){var r;r=o.elements[e].textContent,n+=m(r)+" "}o.options.text=n},d=function(){o.utterance.voice=o.options.voice,o.utterance.volume=o.options.volume,o.utterance.rate=o.options.rate,o.utterance.pitch=o.options.pitch,o.utterance.text=o.options.text,o.utterance.onend=o.options.onend,o.utterance.onstart=o.options.onstart,o.utterance.onerror=o.options.onerror,o.utterance.onmark=o.options.onmark,o.options.debug&&console.log(o.utterance)},m=function(n){var t="",e=/[\n\r]+|[\s]{2,}/g;return void 0!==n&&"string"==typeof n&&(t=n.replace(e," ").trim()),t};return o.play=function(){null===o.options.voice&&u(),c.speak(o.utterance)},o.pause=function(){c.pause(o.utterance)},o.resume=function(){c.resume(o.utterance)},o.stop=function(){c.cancel()},o.onend=function(n){"function"==typeof n&&s({onend:n})},o.onstart=function(n){"function"==typeof n&&s({onstart:n})},o.onerror=function(n){"function"==typeof n&&s({onerror:n})},o.onmark=function(n){"function"==typeof n&&s({onmark:n})},window.onbeforeunload=function(){o.stop()},u(),o}alert("音声読み上げに未対応なブラウザです。\n\n音声読み上げ可能ブラウザ\nGoogle Chrome、Safari、Opera")};return n});