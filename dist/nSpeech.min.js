var nSpeech=function(){"use strict";return function(e,n){if("undefined"!=typeof SpeechSynthesisUtterance){var t=Object.create(nSpeech.prototype),o=void 0!==e?e:".speech",c=[],i=window.speechSynthesis;"object"==typeof e&&(n=o,o=".speech"),t.options={lang:"",voice:null,volume:1,rate:1,pitch:1,text:"",onend:function(){},onstart:function(){},onerror:function(){},onmark:function(){},debug:!1},t.elements=[],t.utterance=new window.SpeechSynthesisUtterance;var r="",u=function(){t.elements=a(o),s(),p(n),c.length>0&&(f(),l(),d())},a=function(e){return document.querySelectorAll(e)},s=function(){c=i.getVoices()},p=function(e){"object"==typeof e&&Object.keys(e).forEach(function(n){t.options[n]=e[n]})},f=function(){var e={};if(c.length>0)for(var n in c){if(c[n].lang===t.options.lang)return t.options.voice=c[n],!0;!0===c[n].default&&(e=c[n])}return t.options.voice=e,!1},l=function(){for(var e=h(t.options.text),n=t.elements.length,o=0;o<n;++o){var c;c=t.elements[o].textContent,e+=h(c)+" "}t.options.text=e},d=function(){t.utterance.voice=t.options.voice,t.utterance.volume=t.options.volume,t.utterance.rate=t.options.rate,t.utterance.pitch=t.options.pitch,t.utterance.text=t.options.text,t.utterance.onend=t.options.onend,t.utterance.onstart=t.options.onstart,t.utterance.onerror=t.options.onerror,t.utterance.onmark=t.options.onmark,t.options.debug&&console.log(t.utterance)},h=function(e){var n="",t=/[\n\r]+|[\s]{2,}/g;return void 0!==e&&"string"==typeof e&&(n=e.replace(t," ").trim()),n};return t.play=function(){null===t.options.voice&&u(),i.speak(t.utterance)},t.pause=function(){i.pause(t.utterance)},t.resume=function(){i.resume(t.utterance)},t.stop=function(){i.cancel()},t.playSelection=function(){var e="";e=window.getSelection?window.getSelection().toString():document.selection.createRange().text,r=t.utterance.text,t.utterance.text=e,t.play()},t.pauseSelection=function(){t.pause()},t.resumeSelection=function(){t.resume()},t.stopSelection=function(){t.utterance.text=r,t.stop()},t.onend=function(e){"function"==typeof e&&p({onend:e})},t.onstart=function(e){"function"==typeof e&&p({onstart:e})},t.onerror=function(e){"function"==typeof e&&p({onerror:e})},t.onmark=function(e){"function"==typeof e&&p({onmark:e})},window.onbeforeunload=function(){t.stop()},window.speechSynthesis.onvoiceschanged=function(){u()},u(),t}alert("音声読み上げに未対応なブラウザです。\n\n音声読み上げ可能ブラウザ\nGoogle Chrome、Safari、Opera")}}();
