/*!
 * nSpeech
 * nSpeech is screen reader library.
 *
 * https://github.com/nkhr7/nSpeech/
 *
 * Copyright 2017, Koichi Yoshimoto
 *
 * Version: 1.0.0
 *
 * Licensed under MIT
 *
 * Released on: 2017.09.29
 */
!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n():e.nSpeech=n()}(this,function(){"use strict";var e=function(n,t){if("undefined"!=typeof SpeechSynthesisUtterance){var o=Object.create(e.prototype),i=void 0!==n?n:".speech",r=[],c=window.speechSynthesis;"object"==typeof n&&(t=i,i=".speech"),o.options={lang:"",voice:null,volume:1,rate:1,pitch:1,text:"",onend:function(){},onstart:function(){},onerror:function(){},onmark:function(){},debug:!1},o.elements={},o.utterance=new window.SpeechSynthesisUtterance;var u=function(){o.elements=s(i),a(),f(t),r.length>0&&(p(),l(),m())},s=function(e){var n={};return void 0!==e&&(n="#"===e.slice(0,1-e.length)?document.getElementById(e.slice(1)):"."===e.slice(0,1-e.length)?document.getElementsByClassName(e.slice(1)):document.getElementsByTagName(e)),n},a=function(){r=c.getVoices()},f=function(e){"object"==typeof e&&Object.keys(e).forEach(function(n){o.options[n]=e[n]})},p=function(){var e={};if(r.length)for(var n in r){if(r[n].lang===o.options.lang)return o.options.voice=r[n],!0;!0===r[n].default&&(e=r[n])}return o.options.voice=e,!1},l=function(e){var n,t="undefined"!=typeof str?e:o.options.text;if(t=d(t),o.elements.length)for(var i in o.elements)n=o.elements[i].textContent,t+=d(n)+" ";else"object"==typeof o.elements&&(n=o.elements.textContent,t+=d(n));o.options.text=t},m=function(){o.utterance.voice=o.options.voice,o.utterance.volume=o.options.volume,o.utterance.rate=o.options.rate,o.utterance.pitch=o.options.pitch,o.utterance.text=o.options.text,o.utterance.onend=o.options.onend,o.utterance.onstart=o.options.onstart,o.utterance.onerror=o.options.onerror,o.utterance.onmark=o.options.onmark,o.options.debug&&console.log(o.utterance)},d=function(e){var n="",t=/[\n\r]+|[\s]{2,}/g;return void 0!==e&&"string"==typeof e&&(n=e.replace(t," ").trim()),n};return o.play=function(){null===o.options.voice&&u(),c.speak(o.utterance)},o.pause=function(){c.pause(o.utterance)},o.resume=function(){c.resume(o.utterance)},o.stop=function(){c.cancel()},o.onend=function(e){"function"==typeof e&&f({onend:e})},o.onstart=function(e){"function"==typeof e&&f({onstart:e})},o.onerror=function(e){"function"==typeof e&&f({onerror:e})},o.onmark=function(e){"function"==typeof e&&f({onmark:e})},window.onbeforeunload=function(){o.stop()},u(),o}alert("音声読み上げに未対応なブラウザです。\n\n音声読み上げ可能ブラウザ\nGoogle Chrome、Safari、Opera")};return e});