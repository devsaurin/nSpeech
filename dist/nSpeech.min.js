var nSpeech=function(){"use strict";return function(n,e){if("undefined"!=typeof SpeechSynthesisUtterance){var t=Object.create(nSpeech.prototype),o=void 0!==n?n:".speech",c=[],u=window.speechSynthesis;"object"==typeof n&&(e=o,o=".speech"),t.options={lang:"",voice:null,volume:1,rate:1,pitch:1,text:"",onboundary:function(){},onend:function(){},onerror:function(){},onmark:function(){},onpause:function(){},onresume:function(){},onstart:function(){},debug:!1},t.elements=[],t.utterance=new window.SpeechSynthesisUtterance;var r="",i=function(){t.elements=a(o),s(),p(e),c.length>0&&(f(),l(),d())},a=function(n){return document.querySelectorAll(n)},s=function(){c=u.getVoices()},p=function(n){"object"==typeof n&&Object.keys(n).forEach(function(e){t.options[e]=n[e]})},f=function(){var n={};if(c.length>0)for(var e in c){if(c[e].lang===t.options.lang)return t.options.voice=c[e],!0;!0===c[e].default&&(n=c[e])}return t.options.voice=n,!1},l=function(){for(var n=y(t.options.text),e=t.elements.length,o=0;o<e;++o){var c;c=t.elements[o].textContent,n+=y(c)+" "}t.options.text=n},d=function(){t.utterance.voice=t.options.voice,t.utterance.volume=t.options.volume,t.utterance.rate=t.options.rate,t.utterance.pitch=t.options.pitch,t.utterance.text=t.options.text,t.utterance.onboundary=t.options.onboundary,t.utterance.onend=t.options.onend,t.utterance.onerror=t.options.onerror,t.utterance.onmark=t.options.onmark,t.utterance.onpause=t.options.onpause,t.utterance.onresume=t.options.onresume,t.utterance.onstart=t.options.onstart,t.options.debug&&console.log(t.utterance)},y=function(n){var e="",t=/[\n\r]+|[\s]{2,}/g;return void 0!==n&&"string"==typeof n&&(e=n.replace(t," ").trim()),e};return t.play=function(){null===t.options.voice&&i(),u.speak(t.utterance)},t.pause=function(){u.pause(t.utterance)},t.resume=function(){u.resume(t.utterance)},t.stop=function(){u.cancel()},t.playSelection=function(){var n="";n=window.getSelection?window.getSelection().toString():document.selection.createRange().text,r=t.utterance.text,t.utterance.text=n,t.play()},t.pauseSelection=function(){t.pause()},t.resumeSelection=function(){t.resume()},t.stopSelection=function(){t.utterance.text=r,t.stop()},t.onboundary=function(n){"function"==typeof n&&p({onboundary:n})},t.onend=function(n){"function"==typeof n&&p({onend:n})},t.onerror=function(n){"function"==typeof n&&p({onerror:n})},t.onmark=function(n){"function"==typeof n&&p({onmark:n})},t.onpause=function(n){"function"==typeof n&&p({onpause:n})},t.onresume=function(n){"function"==typeof n&&p({onresume:n})},t.onstart=function(n){"function"==typeof n&&p({onstart:n})},window.onbeforeunload=function(){t.stop()},window.speechSynthesis.onvoiceschanged=function(){i()},i(),t}alert("音声読み上げに未対応なブラウザです。\n\n音声読み上げ可能ブラウザ\nGoogle Chrome、Safari、Opera")}}();
