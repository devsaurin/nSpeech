var nSpeech=function(){"use strict";return function(n,e){if("undefined"!=typeof SpeechSynthesisUtterance){var t=Object.create(nSpeech.prototype),o=void 0!==n?n:".speech",c=[],r=window.speechSynthesis;"object"==typeof n&&(e=o,o=".speech"),t.options={lang:"",voice:null,volume:1,rate:1,pitch:1,text:"",onboundary:function(){},onend:function(){y()},onerror:function(){},onmark:function(){},onpause:function(){},onresume:function(){},onstart:function(){},debug:!1},t.elements=[],t.utterance=new window.SpeechSynthesisUtterance;var u="",i=function(){t.elements=a(o),s(),f(e),c.length>0&&(p(),l(),m())},a=function(n){return document.querySelectorAll(n)},s=function(){c=r.getVoices()},f=function(n){"object"==typeof n&&Object.keys(n).forEach(function(e){t.options[e]=n[e]})},p=function(){var n={};if(c.length>0)for(var e in c){if(c[e].lang===t.options.lang)return t.options.voice=c[e],!0;!0===c[e].default&&(n=c[e])}return t.options.voice=n,!1},l=function(){for(var n=d(t.options.text),e=t.elements.length,o=0;o<e;++o){var c;c="INPUT"===t.elements[o].tagName||"TEXTAREA"===t.elements[o].tagName?t.elements[o].value:t.elements[o].textContent,n+=d(c)+" "}t.options.text=n},m=function(){t.utterance.voice=t.options.voice,t.utterance.volume=t.options.volume,t.utterance.rate=t.options.rate,t.utterance.pitch=t.options.pitch,t.utterance.text=t.options.text,t.utterance.onboundary=t.options.onboundary,t.utterance.onend=t.options.onend,t.utterance.onerror=t.options.onerror,t.utterance.onmark=t.options.onmark,t.utterance.onpause=t.options.onpause,t.utterance.onresume=t.options.onresume,t.utterance.onstart=t.options.onstart,t.options.debug&&console.log(t.utterance)},d=function(n){var e="",t=/[\n\r]+|[\s]{2,}/g;return void 0!==n&&"string"==typeof n&&(e=n.replace(t," ").trim()),e},h=function(n){var n="";return""!==(n=window.getSelection?window.getSelection().toString():document.selection.createRange().text)&&(u=t.utterance.text,t.utterance.text=n,!0)},y=function(){return""!==u&&(t.utterance.text=u,!0)};return t.play=function(){null===t.options.voice&&i(),h(),r.speak(t.utterance)},t.pause=function(){r.pause(t.utterance)},t.resume=function(){r.resume(t.utterance)},t.stop=function(){y(),r.cancel()},t.replaceText=function(n){t.utterance.text=n},t.changeVolume=function(n){t.utterance.volume=n},t.changeRate=function(n){t.utterance.rate=n},t.changePitch=function(n){t.utterance.pitch=n},t.onboundary=function(n){"function"==typeof n&&f({onboundary:n})},t.onend=function(n){y(),"function"==typeof n&&f({onend:n})},t.onerror=function(n){"function"==typeof n&&f({onerror:n})},t.onmark=function(n){"function"==typeof n&&f({onmark:n})},t.onpause=function(n){"function"==typeof n&&f({onpause:n})},t.onresume=function(n){"function"==typeof n&&f({onresume:n})},t.onstart=function(n){"function"==typeof n&&f({onstart:n})},window.onbeforeunload=function(){t.stop()},window.speechSynthesis.onvoiceschanged=function(){i()},i(),t}alert("音声読み上げに未対応なブラウザです。\n\n音声読み上げ可能ブラウザ\nGoogle Chrome、Safari、Opera")}}();
